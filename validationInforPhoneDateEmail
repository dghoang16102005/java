
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Scanner;

/**
 *
 * @author thaycacac
 */
public class Main {

    private static final Scanner in = new Scanner(System.in);
    private static final String PHONE_VALID = "^[0-9]{10}$";
    private static final String EMAIL_VALID = "^[A-Z0-9a-z._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,4}$";

    private static String checkInputString() {
        //loop until user input true value
        while (true) {
            String result = in.nextLine().trim();
            if (result.isEmpty()) {
                System.err.println("Not empty.");
            } else {
                return result;
            }
        }
    }

    private static String checkInputPhone() {
        while (true) {
            try {
                int phoneCheck = Integer.parseInt(in.nextLine());
                String resultCheck = String.valueOf(phoneCheck);
                if (!resultCheck.matches(PHONE_VALID)) {
                    System.err.println("Phone number must be 10 digits");
                } else {
                    return resultCheck;
                }
            } catch (NumberFormatException ex) {
                System.out.print("Phone number: ");
                System.err.println("Phone number must be number");
            }
        }
    }

    private static String checkInputDate_1() {
        while (true) {
            try {
                String dateCheck = checkInputString();
                Date date = new SimpleDateFormat("dd/MM/yyyy").parse(dateCheck);
                return dateCheck;
            } catch (ParseException ex) {
                System.out.print("Date: ");
                System.err.println("Date to correct format(dd/MM/yyyy)");
            }
        }
    }
    public static String checkInputDate() {
        while (true) {
            System.out.print("Nhập ngày tháng (dd/MM/yyyy): ");
            String dateCheck = checkInputString();
            
            // Kiểm tra định dạng bằng cách tìm các dấu gạch chéo
            if (!dateCheck.matches("\\d{2}/\\d{2}/\\d{4}")) {
                System.err.println("Định dạng không đúng. Vui lòng nhập theo định dạng dd/MM/yyyy.");
                continue;
            }

            // Kiểm tra tính hợp lệ của ngày tháng thủ công
            if (isDateValid(dateCheck)) {
                return dateCheck;
            } else {
                System.err.println("Ngày tháng không hợp lệ. Vui lòng nhập lại.");
            }
        }
    }

    /**
     * Kiểm tra xem một chuỗi ngày tháng có phải là một ngày hợp lệ hay không.
     * @param dateStr Chuỗi ngày tháng ở định dạng dd/MM/yyyy.
     * @return true nếu ngày hợp lệ, ngược lại là false.
     */
    private static boolean isDateValid(String dateStr) {
        try {
            String[] parts = dateStr.split("/");
            int day = Integer.parseInt(parts[0]);
            int month = Integer.parseInt(parts[1]);
            int year = Integer.parseInt(parts[2]);

            // Kiểm tra tháng hợp lệ (1-12)
            if (month < 1 || month > 12) {
                return false;
            }
            
            // Mảng chứa số ngày trong các tháng, bắt đầu từ tháng 1
            int[] daysInMonth = {0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};

            // Kiểm tra năm nhuận và cập nhật số ngày của tháng 2
            boolean isLeapYear = (year % 4 == 0 && year % 100 != 0) || (year % 400 == 0);
            if (isLeapYear) {
                daysInMonth[2] = 29;
            }

            // Kiểm tra xem ngày có hợp lệ không
            return day >= 1 && day <= daysInMonth[month];

        } catch (NumberFormatException | ArrayIndexOutOfBoundsException e) {
            // Xử lý lỗi nếu việc chuyển đổi chuỗi sang số hoặc phân tách chuỗi gặp vấn đề
            return false;
        }
    }

    private static String checkInputEmail() {
        while (true) {
            String emailCheck = checkInputString();
            if (!emailCheck.matches(EMAIL_VALID)) {
                System.err.println("Email must be correct format");
                System.out.print("Email: ");
            } else {
                return emailCheck;
            }
        }
    }

    public static void main(String[] args) {
        System.out.print("Phone number: ");
        String phone = checkInputPhone();
        System.out.print("Date: ");
        String date = checkInputDate();
        System.out.print("Email: ");
        String email = checkInputEmail();
    }
}
